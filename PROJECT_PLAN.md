[🌐 EN VERSION](PROJECT_PLAN_EN.md)

# 🗺️ BIOMETRIC_CONTROL_CENTER 기획 및 아키텍처 

본 문서는 **BIOMETRIC_CONTROL_CENTER (v3.5 Stable)** 의 시스템 설계 철학과 구조, 그리고 개발 페이즈를 안내합니다.

---

## 1. 프로젝트 비전 (Vision)
영화나 게임에서 볼 수 있는 **'미래지향적 보안 통제 센터(Sci-Fi HUD)'** 를 현실에 구현하는 것을 목표로 합니다.
- **오프라인 퍼스트 (Offline-First)**: 외부 인터넷이나 무거운 클라우드 인프라 연결 없이 로컬 환경에서 단독 구동.
- **경량화 및 직관성**: 복잡한 RDBMS 대신 직관적인 `JSON` 기반 저장소 사용.
- **미적 충족성**: 투박한 분석 화면을 탈피한 미려하고 웅장한 대시보드 UI 경험 제공.

---

## 2. 시스템 아키텍처 (Architecture)

시스템은 명확한 역할 분담을 가진 두 가지 계층으로 나뉩니다.

### 🧠 Backend (AI & Data Pipeline)
카메라 하드웨어를 제어하고, 무거운 AI 연산을 수행합니다.
1. **CV 파이프라인 (OpenCV)**: 메인 스레드에서 왜곡 없는 30fps 비디오 스트림 캡처 (MJPEG).
2. **AI 워커 (InsightFace)**: 배경 스레드에서 비동기적으로 얼굴 검출, 특징 벡터 추출, 생체 정보(성별/나이) 분석, 안티-스푸핑(Liveness) 판별.
3. **매치 엔진**: 실시간으로 감지된 얼굴의 벡터를 기존 등록된 인물들의 `SQLite` 데이터(유클리디안 거리/코사인 유사도)와 실시간 비교.
4. **접근 기록 로거 (DB Logger)**: Throttling 로직을 통해 통과된 얼굴 감지 이벤트 내역(Timestamp, Liveness 등)을 SQLite (`access_history`)에 자동 저장.
5. **이벤트 브로드캐스터 (Flask SSE & REST API)**: 연산 완료된 AI 메타데이터 및 DB 로그를 지연 없이 프론트엔드로 푸시 / 제공.

### 👁️ Frontend (Sci-Fi HUD)
백엔드에서 밀어주는 데이터를 시각적으로 화려하게 렌더링합니다.
1. **비디오 레이어**: 백엔드의 `/api/video_feed` (MJPEG)를 끊김 없이 배경으로 재생.
2. **오버레이 렌더러 (Angular)**: SSE 소켓으로 수신한 좌표 데이터에 맞춰 스캐닝 애니메이션과 바운딩 박스를 120Hz 주사율 수준으로 부드럽게 드로잉.
3. **인터랙티브 대시보드 (Angular Material)**: 인물 등록, 타겟 삭제, 시스템 로그 확인 등의 명령을 `/api/xyz` REST API를 통해 백엔드로 전달.

---

## 3. 개발 페이즈 (Development Phases)

### 🟢 Phase 1: 코어 엔진 부트스트랩 (완료)
- 카메라 하드웨어 연동 및 영상 플로우 서버(MJPEG) 구축.
- ArcFace 기반 정밀 얼굴 감지 모듈 통합.
- 기본 Flask 서버 뼈대 생성.

### 🟢 Phase 2: 데이터 영속화와 식별 (완료)
- 메모리 기반이 아닌 로컬 특징 벡터 `SQLite DB` 자동 관리 체계 확립.
- 얼굴 정보(사진+이름)를 기반으로 하는 등록(Enrolling) 로직 설계.
- 미등록(UNKNOWN)과 식별(IDENTIFIED) 타겟 분류 프로세스 완성.

### 🟢 Phase 3: 경험 고도화: Sci-Fi HUD (완료)
- 프론트엔드 기술을 기존 바닐라/템플릿에서 **Angular** 구조로 100% 개편.
- 사이버네틱(Cybernetic) 무드를 위한 SCSS 이펙트(Glow, Scanlines) 적용.
- 한국어 사용자 친화적 경험(UX) 개선 및 한글 웹 폰트 도입.

### 🟢 Phase 4: 생체 지능 확장 및 시스템 최적화 (완료)
- **성별 / 연령 추정** 등 추가적인 메타데이터 추출 레이어 장착.
- 스레딩 및 비동기 처리 구조 리팩토링으로 병목 허들 완화.
- **Docker 컨테이너화**: `docker-compose`를 통한 원클릭 배포 환경 구축.
- **CI/CD 파이프라인**: GitHub Actions를 통한 자동 빌드 및 테스트 자동화 (Pytest, Vitest).
- 문서화 전체 리뉴얼 및 대화형 실행 스크립트 (`run.sh`, `run.bat`) 고도화.

---

## 4. 최종 성공 기준 평가
- [x] **실시간성 보장**: 비디오 스트림 프레임레이트(20~30fps) 안정적 방어.
- [x] **정확도 확보**: InsightFace 모델 기반으로 높은 매칭 인식률 보장.
- [x] **데이터 무결성**: 로컬 DB(JSON) I/O 시 데이터 유실 또는 덮어쓰기 논리 오류 제거.
- [x] **시각적 와우 포인트**: 일반적인 대시보드와 차별화되는 Sci-Fi 테마 완벽 구현.
